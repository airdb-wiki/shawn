<!doctype html><html lang=en dir=ltr><head><meta name=generator content="Hugo 0.85.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="1.make command execute correctly, but the site can&rsquo;t be reached for some reasons.（Solved） #  Description: By using telnet command, we can know certain port&rsquo;s status. As a result, the 1313 port of wsl is running by hugo, but that of windows is closed. Apparently, solve the disconnection between wsl and windows gonna handle this problem.
ref： #    https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html
https://www.cnblogs.com/hapjin/p/5367429.html
 For programs listen to 0.0.0.0 in wsl2, win10 can be accessed directly through localhost:port."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="1.make command execute correctly, but the site can&rsquo;t be reached for some reasons.（Solved） #  Description: By using telnet command, we can know certain port&rsquo;s status. As a result, the 1313 port of wsl is running by hugo, but that of windows is closed. Apparently, solve the disconnection between wsl and windows gonna handle this problem.
ref： #    https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html
https://www.cnblogs.com/hapjin/p/5367429.html
 For programs listen to 0.0.0.0 in wsl2, win10 can be accessed directly through localhost:port."><meta property="og:type" content="article"><meta property="og:url" content="https://airdb.dev/shawn/wiki/doc/problem_set/"><meta property="article:section" content="wiki"><meta property="article:modified_time" content="2021-07-11T10:27:48+08:00"><title>Problem Set | Hugo Book</title><link rel=manifest href=/shawn/manifest.json><link rel=icon href=/shawn/favicon.png type=image/x-icon><link rel=stylesheet href=/shawn/book.min.1639cc58b39d753e5ce211e45ca1950799431f352ff7bd1baadfa7fcedfe8043.css integrity="sha256-FjnMWLOddT5c4hHkXKGVB5lDHzUv970bqt+n/O3+gEM="><script defer src=/shawn/en.search.min.bd6f53b914c6e7dc0601d3cede5ccd31731bfe2fd432a25a8664b76ca06b9a67.js integrity="sha256-vW9TuRTG59wGAdPO3lzNMXMb/i/UMqJahmS3bKBrmmc="></script><script defer src=/shawn/sw.min.205af9424124963fd49320bb6606cc017b6a55a1827142894d7490c8efc7bff8.js integrity="sha256-IFr5QkEklj/UkyC7ZgbMAXtqVaGCcUKJTXSQyO/Hv/g="></script><link rel=apple-touch-icon sizes=128x128 href=128x128.jpg><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?65e05e8c0631a0d2802629f8ceb31fee",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b),console.log("欢迎加入，https://airdb.dev"),console.log("Welcome，https://airdb.dev")})()</script><nav class="app-nav pc no-badge"><div class=logo><a href=//airdb.dev/ target=__blank class=dcloud-logo></a><a href=./ class="uniapp-logo active"></a></div><div class="search nav-search"><div class=input-wrap><input type=search id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class=clear-button><svg width="26" height="24"><circle cx="12" cy="12" r="11" fill="#ccc"/><path stroke="#fff" stroke-width="2" d="M8.25 8.25l7.5 7.5"/><path stroke="#fff" stroke-width="2" d="M8.25 15.75l7.5-7.5"/></svg></div></div><div class=results-panel></div></div><ul class=nav-url></ul><ul class=nav-href><li class=ext-link><a href=https://classroom.google.com/u/1/h target=__blank>ClassRoom</a></li><li><a href=//github.com/sponsors/airdb target=__blank style=color:#f60!important><img src=https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/45e691f0-4f3d-11eb-b680-7980c8a877b8.png class=heart>赞助我们</a></li></ul><div class=github><a href=//github.com/airdb-wiki/hugo-book target=_blank><img src=https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/44f8d690-4f3d-11eb-b680-7980c8a877b8.svg></a></div></nav></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><ul><li><a href=https://airdb.dev/shawn/wiki/doc/>Doc</a><ul><li><a href=https://airdb.dev/shawn/wiki/doc/problem_set/ class=active>Problem Set</a></li></ul></li><li><a href=https://airdb.dev/shawn/wiki/go/>Go</a><ul><li><a href=https://airdb.dev/shawn/wiki/go/gin/>Gin</a></li></ul></li></ul><div class=contact-item><div class=contact-smg><div>扫码添加企业微信</div><img src=https://airdb.dev/hugo-book/qrcode.png width=90 height=90></div></div></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/shawn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Problem Set</strong>
<label for=toc-control><img src=/shawn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1_make_-command-execute-correctly-but-the-site-cant-be-reached-for-some-reasonssolved>1.<em>make</em> command execute correctly, but the site can&rsquo;t be reached for some reasons.（Solved）</a><ul><li><ul><li><a href=#ref>ref：</a></li></ul></li></ul></li><li><a href=#2port-depolyed-at-0000-cant-be-accessed-from-windows-solved>2.Port depolyed at 0:0:0:0 can&rsquo;t be accessed from Windows. (Solved)</a><ul><li><ul><li><a href=#ref-1>ref:</a></li></ul></li></ul></li><li><a href=#3the-connection-from-windows-to-mysql-in-wsl2-failedsolved>3.The connection from Windows to MySQL in WSL2 failed(Solved)</a><ul><li><ul><li><a href=#ref-2>ref:</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=1_make_-command-execute-correctly-but-the-site-cant-be-reached-for-some-reasonssolved>1.<em>make</em> command execute correctly, but the site can&rsquo;t be reached for some reasons.（Solved）
<a class=anchor href=#1_make_-command-execute-correctly-but-the-site-cant-be-reached-for-some-reasonssolved>#</a></h1><p>Description: By using <em>telnet</em> command, we can know certain port&rsquo;s status. As a result, the 1313 port of wsl is running by hugo, but that of windows is closed. Apparently, solve the disconnection between wsl and windows gonna handle this problem.</p><h3 id=ref>ref：
<a class=anchor href=#ref>#</a></h3><blockquote><p><a href=https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html>https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html</a><br><a href=https://www.cnblogs.com/hapjin/p/5367429.html>https://www.cnblogs.com/hapjin/p/5367429.html</a></p></blockquote><p>For programs listen to <strong>0.0.0.0</strong> in wsl2, win10 can be accessed directly through localhost:port. Therefore we have to set bind address equal to 0.0.0.0 on hugo</p><pre><code>hugo server --bind=0.0.0.0 --port=1313 --minify --theme book 
</code></pre><p>Reason: The default address of localhost is Loopback address <strong>127.0.0.1</strong>. It can only be accessed by local machine. So if we want to access wsl2 address from other consoles, we have to replace localhost in /etc/hosts.</p><p>By adding new rule to hugo Makefile, type <code>make win</code> to create local blog on wsl2 that can be accessed on other machines</p><pre><code>wsl win windows:  
hugo server --bind=0.0.0.0 --port=1313 --minify --theme book  
</code></pre><h1 id=2port-depolyed-at-0000-cant-be-accessed-from-windows-solved>2.Port depolyed at 0:0:0:0 can&rsquo;t be accessed from Windows. (Solved)
<a class=anchor href=#2port-depolyed-at-0000-cant-be-accessed-from-windows-solved>#</a></h1><p>Description: Almost the same with <strong>#problem 1</strong>, but Spring is running at 0:0:0:0. Spring-boot&rsquo;s port can&rsquo;t be browsed through Windows browser.</p><h3 id=ref-1>ref:
<a class=anchor href=#ref-1>#</a></h3><blockquote><p><a href=https://github.com/microsoft/WSL/discussions/2471>https://github.com/microsoft/WSL/discussions/2471</a></p></blockquote><p>Using <code>wsl --shutdown</code> solved this problem, and we can also handle this by replacing localhost into the ip address of etho from <strong>ip addr</strong>(for some unknown reasons, the speed is way faster than using localhost)</p><h1 id=3the-connection-from-windows-to-mysql-in-wsl2-failedsolved>3.The connection from Windows to MySQL in WSL2 failed(Solved)
<a class=anchor href=#3the-connection-from-windows-to-mysql-in-wsl2-failedsolved>#</a></h1><p>Description: Connect to MySQL by setting ip as localhost(already set the bind_address=0.0.0.0), but it ended up failure.</p><h3 id=ref-2>ref:
<a class=anchor href=#ref-2>#</a></h3><blockquote><p><a href=https://github.com/microsoft/WSL/issues/4150>https://github.com/microsoft/WSL/issues/4150</a><br><a href=https://stackoverflow.com/questions/61002681/connecting-to-wsl2-server-via-local-network>https://stackoverflow.com/questions/61002681/connecting-to-wsl2-server-via-local-network</a></p></blockquote><p>It seems like Ubuntu host is virtually connected to windows host, and it&rsquo;s netted by the Windows computer. To change that, we gonna forward the wsl2 port to windows, by using</p><pre><code>netsh interface portproxy add v4tov4 listenport=&lt;port-to-listen&gt; listenaddress=0.0.0.0 connectport=&lt;port-to-forward&gt; connectaddress=&lt;forward-to-this-IP-address&gt;
</code></pre><p>Since then, there&rsquo;s another problem as the ip address of wsl2 is dynamic, it will change as you reboot. To improve this method, we should run a script every time we start our computer that does:</p><ol><li><p>Get Ip Address of WSL2 machine</p></li><li><p>Remove previous port forwarding rules</p></li><li><p>Add port Forwarding rules</p></li><li><p>Remove previously added firewall rules</p></li><li><p>Add new Firewall Rules</p><pre><code> $remoteport = bash.exe -c &quot;ifconfig eth0 | grep 'inet '&quot;
 $found = $remoteport -match '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}';

 if( $found ){
 $remoteport = $matches[0];
 } else{
 echo &quot;The Script Exited, the ip address of WSL 2 cannot be found&quot;;
 exit;
 }

 #[Ports]

 #All the ports you want to forward separated by coma
 $ports=@(80,443,10000,3000,5000);


 #[Static ip]
 #You can change the addr to your ip config to listen to a specific address
 $addr='0.0.0.0';
 $ports_a = $ports -join &quot;,&quot;;


 #Remove Firewall Exception Rules
 iex &quot;Remove-NetFireWallRule -DisplayName 'WSL 2 Firewall Unlock' &quot;;

 #adding Exception Rules for inbound and outbound Rules
 iex &quot;New-NetFireWallRule -DisplayName 'WSL 2 Firewall Unlock' -Direction Outbound -LocalPort $ports_a -Action Allow -Protocol TCP&quot;;
 iex &quot;New-NetFireWallRule -DisplayName 'WSL 2 Firewall Unlock' -Direction Inbound -LocalPort $ports_a -Action Allow -Protocol TCP&quot;;

 for( $i = 0; $i -lt $ports.length; $i++ ){
 $port = $ports[$i];
 iex &quot;netsh interface portproxy delete v4tov4 listenport=$port listenaddress=$addr&quot;;
 iex &quot;netsh interface portproxy add v4tov4 listenport=$port listenaddress=$addr connectport=$port connectaddress=$remoteport&quot;;
 }
</code></pre></li></ol><p>The script must run under highest privilege. Use task scheduler to automatically start powershell and add argument as <code>-ExecutionPolicy Bypass c:\scripts\wslbridge.ps1</code>.</p><p>Tips: Navicat should change the ip to 127.0.0.1 instead of localhost.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/airdb-wiki/lang/commit/8b8e9057e3a1ced1216e0cc6c3ad4b0a58dac91d title="Last modified by Shawn | Sun Jul 11 02:27:48 UTC 2021" target=_blank rel=noopener><img src=/shawn/svg/calendar.svg class=book-icon alt=Calendar>
<span>Sun Jul 11 02:27:48 UTC 2021</span></a></div><div><a class="flex align-center" href=https://github.com/airdb-wiki/lang/edit/main/content/content/wiki/doc/problem_set.md target=_blank rel=noopener><img src=/shawn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1_make_-command-execute-correctly-but-the-site-cant-be-reached-for-some-reasonssolved>1.<em>make</em> command execute correctly, but the site can&rsquo;t be reached for some reasons.（Solved）</a><ul><li><ul><li><a href=#ref>ref：</a></li></ul></li></ul></li><li><a href=#2port-depolyed-at-0000-cant-be-accessed-from-windows-solved>2.Port depolyed at 0:0:0:0 can&rsquo;t be accessed from Windows. (Solved)</a><ul><li><ul><li><a href=#ref-1>ref:</a></li></ul></li></ul></li><li><a href=#3the-connection-from-windows-to-mysql-in-wsl2-failedsolved>3.The connection from Windows to MySQL in WSL2 failed(Solved)</a><ul><li><ul><li><a href=#ref-2>ref:</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>